-- CLIENTES
create table if not exists clientes (
  id bigint generated by default as identity primary key,
  nome varchar(120) not null,
  cpf varchar(20) not null,
  celular varchar(40),
  endereco varchar(200),
  email varchar(120) not null unique
);

-- INGREDIENTES (duplicado aqui para uso das receitas)
create table if not exists ingredientes (
  id bigint primary key,
  descricao varchar(255) not null
);

-- PRODUTOS
create table if not exists produtos (
  id bigint primary key,
  descricao varchar(120) not null,
  preco decimal(10,2) not null
);

-- RECEITAS (se o teu projeto tiver uma entidade/consulta de “receita”)
create table if not exists receitas (
  id bigint generated by default as identity primary key,
  descricao varchar(120) not null
);

-- RELAÇÃO PRODUTO x INGREDIENTE (ou RECEITA x INGREDIENTE, conforme teu JDBC)
-- Se teu JDBC mapeia diretamente produto->ingrediente, use esta:
create table if not exists produto_ingrediente (
  produto_id bigint not null,
  ingrediente_id bigint not null,
  quantidade int not null,
  primary key (produto_id, ingrediente_id),
  foreign key (produto_id) references produtos(id),
  foreign key (ingrediente_id) references ingredientes(id)
);

-- CARDÁPIO
create table if not exists cardapios (
  id bigint generated by default as identity primary key,
  descricao varchar(120) not null,
  ativo boolean not null
);

-- RELAÇÃO CARDÁPIO x PRODUTO
create table if not exists cardapio_produto (
  cardapio_id bigint not null,
  produto_id bigint not null,
  primary key (cardapio_id, produto_id),
  foreign key (cardapio_id) references cardapios(id),
  foreign key (produto_id) references produtos(id)
);

-- PEDIDOS
create table if not exists pedidos (
  id bigint generated by default as identity primary key,
  cliente_email varchar(120) not null,
  data_criacao timestamp default current_timestamp,
  status varchar(30) not null,
  total decimal(10,2) not null default 0,
  foreign key (cliente_email) references clientes(email)
);

-- ITENS DO PEDIDO
create table if not exists itens_pedido (
  id bigint generated by default as identity primary key,
  pedido_id bigint not null,
  produto_id bigint not null,
  quantidade int not null,
  preco_unitario decimal(10,2) not null,
  foreign key (pedido_id) references pedidos(id),
  foreign key (produto_id) references produtos(id)
);
